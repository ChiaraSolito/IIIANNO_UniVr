\documentclass{article}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{booktabs, siunitx}
\usepackage{tikz}
\usepackage{tikz-qtree}
\usepackage{pifont}
\usepackage[margin=0.90in]{geometry}
\usepackage{etoolbox,titling}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{soulutf8}
\usepackage{epigraph}
\usepackage{amssymb}
\usepackage{amsmath}

\pagestyle{fancy}
\fancyhf{}
\rhead{Chiara Solito}
\lhead{Dispense di Laboratorio di Bioinformatica}
\rfoot{Pagina \thepage}
\lfoot{Bioinformatica - A.A. 2021/22}
\usetikzlibrary{trees}
\tikzstyle{every node}=[draw=black,thick,anchor=west]
\newcommand{\angstrom}{\mbox{\normalfont\AA}}

\begin{document}
\newcommand\tab[1][0.3cm]{\hspace*{#1}}


\begin{titlepage}
    \begin{center}
        \vspace*{1cm}
            
        \Huge
        \textbf{Laboratorio di Bioinformatica}
            
        \vspace{0.5cm}
        \LARGE
        Dispense del corso - Modulo 2
            
        \vspace{1.5cm}
            
        \textbf{Chiara Solito}

        \vspace{0.8cm}

            
        \Large
        Corso di Laurea in Bioinformatica\\
        Università degli studi di Verona\\
        A.A. 2021/22
            
    \end{center}
\end{titlepage}
La presente è una dispensa riguardante il corso di \textbf{Laboratorio di Bioinformatica} del CdS in Bioinformatica (Università degli Studi di Verona). Per la stesura di questa dispensa si è fatta fede al materiale didattico fornito direttamente dal professore nell'Anno Accademico 2021/2022. Eventuali variazioni al programma successive al suddetto anno non saranno quindi incluse.\\
Insieme a questo documento in formato PDF viene fornito anche il codice \LaTeX  con cui è stato generato.
\tableofcontents
\thispagestyle{empty}
\newpage
\thispagestyle{empty}

\section{Introduzione}
La Bioinformatica è una disciplina molto recente, il nostro corso è il primo in laurea triennale in Italia.
\paragraph{Wikipedia:} La bioinformatica è una disciplina scientifica dedicata alla risoluzione
di problemi biologici a livello molecolare con metodi informatici.\\
A cosa pensiamo quando parliamo di Bioinformatica:
\begin{itemize}
    \item Microarraay
    \item Genetica Forense 
    \item Basi di Dati
    \item 3D Modeling
    \item Interazione Molecolare 
    \item Antropologia Evolutiva
    \item Disegno di Molecole 
    \item Antropologia Evolutiva 
\end{itemize}

\subsection{Cos'è quindi la Bioinformatica?}
La bioinformatica è la disciplina scientifica che cerca di risolvere problemi biologici mediante l'elaborazione informatica dell'informazione proveniente diretta o indirettamente da essere viventi. È nata per permettere all'informatica di organizzare e rendere disponibili i dati biologici.
La Bioinformatica è una scienza che risolve problemi biologici attraverso l'elaborazione di materiale proveniente da esseri viventi. Questo materiale è in genere sono \textbf{sequenze di DNA.} L'utilizzo dell'informatica è necessario per elaborare la grande quantità dei dati.
La quantità di dati biologici a disposizione, è paragonabile solo all'astrofisica. Sono troppi per non affrontarli in maniera informatica.\\
\paragraph{I "fields" della bioinformatica:}
\begin{itemize}
    \item Genome Analysis
    \item Sequence Analysis
    \item Phylogenetics
    \item Fene Expression
    \item Systems Biology
    \item Data and Text Mining (algoritmi che leggono abstract o articoli)
\end{itemize}
La bioinformatica copre tutti questi campi.

\paragraph{Chiamata alle varianti:} cosa cambia nella proteina o nel gene rispetto a quello di riferimento, e dopo un'analisi statistica riescono a collegarlo ad una malattia (qual è l'effetto della variante sulla proteina?)\\
Per questo è bene ricordare che l'informazione di partenza sono le sequenze proteiche o nucleotidiche. L'obbiettivo ultimo è quello di estrarre informazioni dalle sequenze. Tali sequenze rappresentano l'informazione disponibile e possono essere:
\begin{itemize}
    \item Sequenze genomiche\\  (DNA genomico: genomi, esomi o alcune regioni particolari del genoma).
    \item Sequenze proteiche\\ (cDNA cioè DNA retrotrascritto a partire da un mRNA)
    \item Immagini\\ (RX, TAC, MRI, US, ecc)
    \item Strutture 3D di proteine\\ (NMR, Cristallografia), biologia strutturale
    \item Informazioni provenienti da System Biology \\ Informazione di interazione tra molecole
    \item Informazioni di carattere evoluzionistico
    \item Pulsazioni, respiri, battiti cardiaci,$ \dots $
    \item Concentrazioni di particelle nel sangue.
\end{itemize}
Una cosa molto recente è la medicina di precisione: una volta si parlava di medicina personale, conoscendo il sequenziamento genomico di una persona, si può conoscere tutta la sua storia clinica? Capiamo le malattie a livello personalizzato.\\
In questo modulo ci concentreremo sull'annotazione genomica e sulla bioinformatica strutturale e poi anche il risequenziamento del genoma.\\
Il Covid è stato un campo di prova molto importante. In questo modulo ci concentreremo sull’annotazione genomica e sulla bioinformatica strutturale e poi anche il risequenziamento del genoma.

\subsection{Cos'è la Genomica?}
La genomica è una branca della biologia molecolare che si occupa dello studio
del genoma degli organismi viventi. In particolare si occupa della struttura,
contenuto, funzione ed evoluzione del genoma. È una scienza che si basa
sulla bioinformatica per l'elaborazione e la visualizzazione dell'enorme quantità di
dati che produce.
\paragraph{Cosa studia la genomica?}
\begin{itemize}
    \item Estrazione e/o cattura di DNA da essere viventi.
    \item Sequenziamento del DNA con tecniche all’avanguardia come NGS
    (Next Generation Sequencing).
    \item Assemblaggio di genomi a partire da milioni di frammenti di DNA.
    \item Ri-sequenziamento di genomi.
    \item Allineamento Allineamento di frammenti frammenti di DNA a un genoma di riferimento riferimento. \item Annotazione di genomi. \item Annotazione funzionale di geni all’interno di un genoma.
    \item Analisi di espressione genica mediante sequenziamento dei
    trascritti (RNA-Seq).
    \item GWAS (Genome Wide Association Studies).
    \item Analisi di varianti tra genomi (Variant calling o Chiamata delle
    varianti)
\end{itemize}

\section{Ottimizzazione del protocollo bioinformatico per l’annotazione di geni codificanti proteine in genomi complessi}
Un genoma sequenziato ma non ben annotato non serve a molto.\\
Con l’avvento del sequenziamento con costi sempre più contenuti, il numero di genomi sequenziati sta incrementando considerevolmente. Lo scopo di conoscere la sequenza genomica è principalmente indirizzato a capire la funzionalità dei geni.\\
Il progetto "Encode" ha dato il via all'annotazione come la conosciamo, tramite la produzione di protocolli
Annotare un genoma significa conoscere la localizzazione, la struttura, la funzionalità di tutti gli elementi che compongono l’intero genoma. In pratica l’annotazione è quello che si deve fare dopo aver sequenziato un certo genoma. Gli elementi che vengono annotati sono:
\begin{enumerate}
    \item Geni codificanti proteine
    \item Geni non codificanti proteine
    \item Elementi regolatori
    \item Elementi ripetuti
    \item Pseudogeni = geni che hanno perso la funzione codifica
    \item Altri elementi
\end{enumerate}
\paragraph{Come si cerca un gene all'interno del genoma?}
Faccio un allineamento: è la prima cosa che devo fare! Faccio un allineamento tramite BLAST (P o N o quello che è). Incollando la sequenza troverò delle sequenze simili nelle banche dati (\textbf{voglio mappare la regione}). Questo è uno dei metodi, il più semplice.\\

Nel corso del tempo si è capito che non basta annotare solo le zone esoniche ma bisogna considerare anche il resto come gli elementi regolatori.
Con ri-sequenziamento del genoma di un paziente si intende mappare il DNA su un genoma di riferimento per confrontare le varianti manifestate.
L’annotazione dei geni codificanti proteine, viene suddivisa in:
\begin{itemize}
    \item Annotazione funzionale\\Consiste nel caratterizzare ogni
    singolo gene, assegnando una funzione biologica a ogni proteina
    codificata dal gene stesso.
    \item Annotazione genica o semplicemente annotazione\\ consiste
    nel definire all’interno del genoma:
        \subitem{-} La localizzazione di ciascun gene. \item La struttura di ciascun gene (esoni,
        CDS, UTR).
        \subitem{-} Gli eventuali trascritti alternativi.
\end{itemize}
\begin{center}
    \includegraphics[width=0.5\textwidth]{figures/mrna-dna.png}
\end{center}
\subsection{Il modello genico}
In questo modulo ci occuperemo anche di studiare algoritmi di predizione di strutturale di geni dalla loro sequenza. Quello che bisogna fare è utilizzare HMM per costruire un modello che descriva probabilisticamente le conformazioni possibili.
Occorre operare sempre una divisione in training e test set. In ogni caso bisogna sempre partire dalla definizione di gene riassunta nell’immagine seguente:
\begin{center}
    \includegraphics[width=0.5\textwidth]{figures/model.png}
\end{center}
Un gene codificante proteine è composto da diversi elementi:
\begin{itemize}
    \item Esone: regione che viene mantenuta dopo la maturazione.
    \item Introne: regione che viene eliminata durante la maturazione.
    \item mRNA: RNA maturo, composto da esoni.
    \item CDS: regione codificante dell‘mRNA.
    \item UTR: regione non tradotta dell’mRNA.
\end{itemize}
\subsection{Formato di File di Annotazione GFF3}
\begin{center}
    \includegraphics[width=0.5\textwidth]{figures/GFF3.png}
\end{center}
\subsection{Metodi per l'identificazione dei geni codificanti proteine}
\begin{itemize}
    \item Metodi basati sull’allineamento delle evidenze sperimentali.
    \item Metodi basati sulla predizione predizione genica ab
    initio.
    \item Metodi basati sulla predizione genica ab
    initio guidata da evidenze sperimentali.
    \item Metodi basati sul confronto tra genomi.
\end{itemize}

\subsubsection{Metodi basati sull’allineamento delle evidenze sperimentali}
Si possono utilizzare diverse evidenze sperimentali, che
opportunamente elaborate e allineate al genoma
permettono di identificare le regioni codificanti proteine:
\begin{itemize}
    \item cDNA full-length: sequenze di RNA maturi (mRNA)
    retrotrascritti a cDNA, quindi completo di UTR e CDS.
    \item EST (Expressed Sequence Tags): brevi frammenti parziali, tra
    400-800 bp, di mRNA retrotrascritti retrotrascritti a cDNA. 
    \item Proteine omologhe: sequenze aminoacidiche corrispondenti a
    proteine omologhe di organismi evolutivamente vicini.
    \item Tiling arrays: microarray con sonde equamente spaziate su
    tutto il genoma, permettono l’identificazione di regione
    espresse mediante l’ibridazione di campione marcati.
    \item MPSS: Massively Parallel Signature Sequencing, piattaforma
    che analizza il livello di espressione e identifica una regione di
    17-20 bp degli mRNA tramite sequenziamento.
    \item RNA-seq: frammenti di cDNA di lunghezza tra 50-150 bp che
    derivano dal sequenziamento shotgun di un intero trascrittoma.
\end{itemize}
\paragraph{EST - Express Sequence Tag}
Sequenziamenti veloci di tessuti interi, in cui le etichette dei primi e degli ultimi nucleotidi sono ben sequenziati, in mezzo invece hanno errori. Però per annotare velocemente sono molto importanti.\\
Sono dei brevi frammenti di lunghezza tra 400-800 bp di cDNA
ottenuto dalla retrotrascrizione di un frammento di RNA maturo.
\begin{center}
    \includegraphics[width=0.5\textwidth]{figures/EST.png}
\end{center}
\paragraph{Proteine Omologhe}
Dalla sequenza proteica delle proteine si può risalire alla
sequenza nucleotidica e quindi alla zona codificante (CDS) del
gene che l’ha codificata.
\begin{center}
    \includegraphics[width=0.5\textwidth]{figures/omolog.png}
\end{center}
\paragraph{RNA Seq}
Sono sequenze di lughezza tra 50-150 bp che derivano dal sequenziamento shotgun di un
intero trascrittoma, cioè dalla retro-trascrizione di tutto l’RNA in cDNA di un particolare
momento cellulare, poi spezzato e sequenziato con tecnologie NGS.
\begin{center}
    \includegraphics[width=0.5\textwidth]{figures/rnaseq.png}
\end{center}
\subsubsection{Metodi basati sulla predizione predizione genica ab initio}
Per identificare le regioni codificanti i predittori utilizzano algoritmi e modelli
matematici specifici che utilizzando informazione intrinseca dell’organismo
analizzato cercano di identificare la localizzazione e la struttura dei geni.
\begin{itemize}
    \item Sensori di segnale (\textit{signal sensors}): permettono di identificare le giunzioni
    esone-introne e le estremità delle regioni codificanti.
    \item Sensori Sensori di contenuto contenuto (\textit{content sensors}): permettono permettono di identificare identificare le
    regioni codificanti di lunghezza variabile.
\end{itemize}
I predittori hanno bisogno di dati di esempio per imparare le caratteristiche
dell’organismo analizzato (dati di training) e dei dati di prova per valutare
l’accuratezza delle predizioni (dati di test).

\begin{center}
    \begin{tabular}{*{8}c}
        \toprule
        \multicolumn{1}{p{1.5cm}}{\centering Predittore}
        & \multicolumn{1}{p{1.5cm}}{\centering Predizione ab initio}
        & \multicolumn{1}{p{1.5cm}}{\centering Predizione di geni eucarioti} & 
        \multicolumn{1}{p{1.5cm}}{\centering Training in locale per nuovi genomi} & 
        \multicolumn{1}{p{1.5cm}}{\centering Utilizzo di EST e Proteine per la predizione} &
        \multicolumn{1}{p{1.5cm}}{\centering Utilizzo di RNA-Seq per la predizione} 
        & \multicolumn{1}{p{1.5cm}}{\centering Predizione degli UTR}
        & \multicolumn{1}{p{1.5cm}}{\centering Predizione dei trascritti alternativi} \\
        \midrule
        Augustus & SI & SI & SI & SI & SI & SI & SI \\
        Snap & SI & SI & SI & NO & NO & NO & NO\\
        GeneMark-ES & SI & SI & NO & NO & NO & NO & NO\\
        GeneID & SI & SI & SI & SI & SI & SI & SI \\
        FGenesh & SI & SI & SI & NO & NO & NO & NO \\
        Genescan & SI & SI & NO & SI & SI & SI & NO \\
        MZEF & SI & SI & NO & NO & NO & NO & NO \\
        mGene.NGS & SI & SI & SI & SI & SI & SI & NO \\
        Contrast & SI & SI & SI & SI & NO & SI & NO \\
        GrailExp & SI & SI & NO & SI & NO & SI & NO \\
        TwinScan/N-Scan & SI & SI & SI & SI & NO & NO & SI
    \end{tabular}
\end{center}

\subsubsection{Metodi basati sulla predizione genica ab initio guidata da evidenze sperimentali}
Predizione genica ab initio: utilizza dati di training che potrebbero non
essere rappresentativi di tutti i geni del genoma.\\
Evidenze sperimentali: non coprono mai tutto il genoma, quindi non
permettono l’annotazione completa di tutti i geni codificanti proteine.\\
I migliori metodi di predizione genica utilizzano una metodologia
ibrida tra predizione predizione genica ab initio e l’utilizzo l’utilizzo degli allineamenti allineamenti delle
evidenze sperimentali:
\begin{itemize}
    \item cDNA
    \item Proteine
    \item EST
    \item RNA-seq
\end{itemize}

\subsection{Annotazione finale}
Creazione di un consensus utilizzando le evidenze sperimentali e le predizioni geniche.
Ciascuna evidenza viene pesata dando un peso maggiore ai
dati sperimentali rispetto alle predizioni.
Principali programmi
di integrazione:
\begin{itemize}
    \item Evidence Modeller
    \item JIGSAW
    \item GAZE
\end{itemize}

\section{Pipeline automatizzata di annotazione genica}
Basate su automazione di programmi di predizione e
allineamento esistenti.
\begin{itemize}
    \item Vantaggio: relativamente semplici da utilizzare.
    \item Svantaggio: consentono un controllo limitato dei passaggi
    intermedi dell’annotazione.
\end{itemize}
Pipeline di annotazione più utilizzate:
\begin{itemize}
    \item PASA 
    \item MAKER 
\end{itemize}
\subsection{Obiettivo}
L’ottimizzazione del protocollo bioinformatico
per l’annotazione dei geni codificanti proteine
in genomi complessi. A questo scopo non verrà utilizzata una
pipeline automatica di annotazione ma,
attraverso la scelta di metriche adeguate,
verrà valutato ogni singolo passaggio
intermedio dell’annotazione in modo da
fornire una procedura ottimizzata sulla base
delle evidenze sperimentali a disposizione.

\subsection{Genoma di riferimento}
Genoma dell’organismo eucariote Vitis
vinifera, versione V1 PN40024 12X del
consorzio French-Italian Public
Consortium for Grapevine Genome, con
una dimensione dimensione di 487 Mb.\\
Motivi di questa scelta:
\begin{itemize}
    \item Il genoma è disponibile
    \item Ci sono dati sperimentali disponibili
    (EST, 454, RNA-Seq, cDNA full-length)
\end{itemize}
\subsection{Preparazione del dataset di riferimento}
\begin{itemize}
    \item 16.054 contig di cDNA full-length prodotte dal consorzio FrenchItalian Public Consortium for Grapevine Genome $\rightarrow$ 3752 cDNA non ridondanti.
    \item Rimozione delle sequenze con ORF non completa  3.436 $\rightarrow$ sequenze.
    \item Le 3.436 sequenze sequenze sono state suddivise suddivise in due gruppi in maniera maniera
    del tutto casuale:
        \subitem{-} 936 sequenze di cDNA full-length $\rightarrow$ training.
        \subitem{-} 2.500 sequenze di cDNA full-length $\rightarrow$ test.
\end{itemize}
\begin{center}
    \includegraphics[width=0.5\textwidth]{figures/dataset.png}
\end{center}

\subsection{Preparazione ed allineamento delle evidenze sperimentali}
\begin{itemize}
    \item \textbf{EST:}\\ 2.713.343 sequenze EST pubbliche (NCBI,
    Sequenziamento 454 + banca dati del consorzio). \\Allineamento e generazione modelli genici con Gmap.\\$\rightarrow$ 1.649.082 trascritti putativi ridondati (56.630 non
    ridondanti).
    \item \textbf{Proteine omologhe:}\\Allineamento Allineamento al genoma delle sequenze sequenze proteiche proteiche di
    tutto il database SWISSPROT utilizzando Blat, Blast e Genewise.\\
    $\rightarrow$ 22.355 trascritti putativi ridondanti (5.808 non
    ridondanti).
    \item \textbf{RNA-seq:}\\114.726.580 reads RNA-seq sequenziati dal laboratorio
    di genomica dell’Università di Verona (pool di 45
    campioni provenienti da 15 tessuti e organi a diversi
    stadi di sviluppo).\\Allineamento e generazione modelli genici con suite
    Bowtie + Tophat + Cufflinks.\\
    $\rightarrow$ 40.324 trascritti putativi ridondanti (17.444 non
    ridondanti).
\end{itemize}
\subsection{Statistiche generali degli allineamenti delle evidenze sperimentali}
\begin{center}
    \begin{tabular}{| c | c | c | c}
        \toprule
        \multicolumn{1}{p{2cm}}{\centering Statistiche generali} &
        \multicolumn{1}{p{2cm}}{\centering EST} &
        \multicolumn{1}{p{2cm}}{\centering Proteine omologhe} &
        \multicolumn{1}{p{2cm}}{\centering RNA-seq}\\
        \midrule
        Numero di modelli genici allineati & 56.630 &  5.808 & 17.444\\
        Numero di modelli genici multi esonici & 19.485 & 3.175 & 17.366\\
        Media della lunghezza dei modelli genici & 1.034,12 & 874,42 & 2.236,89\\
        N50 della lunghezza dei modelli genici & 2.257 & 1.563 & 2.751\\
        Media del numero di esoni per modello genico & 3,30 & 4,39 & 6,75\\
    \end{tabular}
\end{center}   
Distribuzione della percentuale di sovrapposizione di nucleotidi tra allineamenti e riferimento.
\begin{center}
    \includegraphics[width=0.5\textwidth]{figures/stats.png}
\end{center}

\section{Il covid}
\paragraph{Gli articoli scientifici durante il covid}
Le tempistiche di review degli articoli non sono compatibili con quelle di lotta al covid, le ricerche portano via tanto tempo, una volta mandate a un giornale sono analizzate da un editor: decide se è d’accordo con gli obiettivi del giornale. Allora viene mandato ai reviewers, anonimi esperti che analizzano il lavoro, commentano, approvano, non approvano, ecc. In questo caso l’editor può bocciare, chiedere minor or major revisions oppure accettarlo. Si può fare avanti e indietro tra queste cose per mesi.
Durante la lotta al covid si sono creati dei giornali di pre-print: appena finita la ricerca la si può depositare su queste banche dati, a cui viene assegnato un DOI (protegge la proprietà intellettuale). In quel caso è già a disposizione della comunità scientifica: 
\begin{itemize}
    \item Molti articoli venuti fuori nelle notizie erano in pre print, quindi non erano articoli revisionati manualmente
    \item L’informazione negli articoli di pre print è stata categorizzata da algoritmi di machine learning, e questo ha aiutato a comprendere articoli di aiuto alla lotta al covid.
\end{itemize}
\paragraph{Cosa c'è ancora da fare in merito al covid?}
Trovare un vaccino che sia pan-coronavirus. Trovare le regioni della proteina spike più conservate, che permettano di neutralizzare la proteina di tutte le varianti.\\
Lo sviluppo di antivirali in grado di abbattere il virus, al momento ce n'è uno Pfizer (marzo 2022), che non colpiscono le proteine spike ma quelle di replicazione e funzionamento.

\section{Predizione Genica}
\subsection{Informazioni di Base}
Ogni predizione genica è un ipotesi che aspetta di essere testata, i risultati dei testi informano il nuovo set di ipotesi.\\
L'estrapolazione dei geni è un processo di:
\begin{itemize}
    \item Identificare i fenomeni comuni nei geni noti 
    \item Costruire un modello accurato che descriva il fenomeno 
    \item Scannerizzare il genoma per identificare le regioni che matchano il mio modello 
    \item Abbiamo una predizione, che dobbiamo validare e testare
\end{itemize}
\subsection{Appocci alla Gene Finding}
\begin{itemize}
    \item Metodi Diretti \\ Vado direttamente a cercare dove posso mappare le cose conosciute: cerco metch esatti o simili di EST, cDNA o proteine
    \item Metodi Indiretti
        \begin{enumerate}
            \item Cerco per omologia qualche gene particolare (homology)
            \item Cercare qualcosa che sia come tutti i geni (ab initio)
            \item Metodi che combinano i due precedenti
        \end{enumerate}
\end{itemize}

\end{document}